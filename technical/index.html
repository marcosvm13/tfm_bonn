<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Detalles Técnicos - BONN: Bio-Inspired Olfactory Neural Network</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">BONN: Bio-Inspired Olfactory Neural Network</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href=".." class="nav-link">Inicio</a>
                            </li>
                            <li class="nav-item">
                                <a href="../installation/" class="nav-link">Instalación</a>
                            </li>
                            <li class="nav-item">
                                <a href="../usage/" class="nav-link">Uso</a>
                            </li>
                            <li class="nav-item">
                                <a href="./" class="nav-link active" aria-current="page">Detalles Técnicos</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../usage/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" class="nav-link disabled">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#documentacion-tecnica-del-proyecto-bonn" class="nav-link">Documentación Técnica del Proyecto BONN</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#1-arquitectura-bonn" class="nav-link">1. Arquitectura BONN</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#2-gatebonn-version-bayesiana-con-compuertas" class="nav-link">2. GateBONN (versión bayesiana con compuertas)</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#3-ensemblebonn" class="nav-link">3. EnsembleBONN</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#4-experimentos-y-evaluacion" class="nav-link">4. Experimentos y Evaluación</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#5-entradas-y-salidas" class="nav-link">5. Entradas y Salidas</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#6-implementacion-tecnica" class="nav-link">6. Implementación técnica</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#7-requisitos" class="nav-link">7. Requisitos</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="documentacion-tecnica-del-proyecto-bonn">Documentación Técnica del Proyecto BONN</h1>
<p>Este repositorio implementa modelos bioinspirados en el sistema olfativo de los insectos, enfocados en tareas de clasificación con pocos datos. Las arquitecturas propuestas reproducen mecanismos funcionales clave del procesamiento sensorial en <em>Drosophila melanogaster</em>, como la codificación dispersa, la especialización funcional y la robustez estructural.</p>
<h2 id="1-arquitectura-bonn">1. Arquitectura BONN</h2>
<p>BONN (Bio-inspired Olfactory Neural Network) simula la vía sensorial AL → KC → MBON. Su estructura consta de:</p>
<ul>
<li><strong>Proyecciones fijas desde AL a KC</strong>: Representadas mediante matrices de conexión binarias, dispersas y parcialmente estructuradas. Esta matriz se inicializa una única vez al comienzo y no se entrena.</li>
<li>
<p><strong>Codificación dispersa</strong>: Controlada mediante dos hiperparámetros:</p>
</li>
<li>
<p><code>s</code>: tasa de activación objetivo para cada entrada.</p>
</li>
<li><code>pc</code>: probabilidad de conexión de cada neurona de KC con entradas del AL.</li>
<li><strong>Salida entrenable (MBON)</strong>: Una única capa lineal entrenada con descenso por gradiente.</li>
<li><strong>Función de activación</strong>: Sigmoide o variantes suaves, usada para mantener la interpretabilidad de las tasas de activación.</li>
</ul>
<p>La implementación principal está escrita en CuPy para acelerar la ejecución mediante operaciones vectorizadas en GPU. El uso de máscaras binarias permite simular la conectividad estructural AL→KC de forma eficiente.</p>
<h2 id="2-gatebonn-version-bayesiana-con-compuertas">2. GateBONN (versión bayesiana con compuertas)</h2>
<p>GateBONN extiende BONN incorporando mecanismos bayesianos de control de activación:</p>
<ul>
<li><strong>Compuertas estocásticas diferenciables</strong>: Se utiliza la relajación de Gumbel-Sigmoid para permitir el paso de gradientes en compuertas binarias.</li>
<li><strong>Distribuciones beta</strong>: Cada compuerta tiene una distribución Beta con parámetros aprendidos. Esto permite modelar explícitamente la probabilidad de activación de cada neurona.</li>
<li><strong>Regularización por divergencia KL</strong>: Se añade un término en la función de pérdida que penaliza desviaciones respecto a un prior Beta, promoviendo escasez y control de entropía.</li>
<li><strong>Cálculo de información mutua</strong>: Se estima la dependencia entre las activaciones internas y las clases objetivo usando un término tipo InfoNCE o una medida basada en codificación cruzada.</li>
</ul>
<p>Este modelo está implementado completamente en PyTorch, aprovechando su compatibilidad con autograd y su ecosistema de entrenamiento distribuido.</p>
<h2 id="3-ensemblebonn">3. EnsembleBONN</h2>
<ul>
<li><strong>Agregación de modelos BONN independientes</strong>: Se generan múltiples instancias de BONN con distintas inicializaciones estructurales (máscaras de conexión).</li>
<li><strong>Votación suave (soft voting)</strong>: Las salidas de cada modelo se combinan promediando las probabilidades clase a clase.</li>
<li><strong>Evaluación progresiva</strong>: Se mide cómo mejora la precisión del conjunto a medida que se agregan modelos, desde 1 hasta 100.</li>
<li><strong>Motivación biológica</strong>: Refleja la diversidad funcional de subpoblaciones KCs en el MB (α, β, γ).</li>
</ul>
<h2 id="4-experimentos-y-evaluacion">4. Experimentos y Evaluación</h2>
<p>Se han llevado a cabo varios experimentos para validar el rendimiento y las propiedades internas de BONN y sus variantes:</p>
<ul>
<li><strong>Comparación con modelos clásicos</strong>: Se comparan BONN, GateBONN y EnsembleBONN con MLP, ELM y RFM bajo entrenamiento superficial (una época).</li>
<li><strong>Fast learning</strong>: Evaluación de precisión en función del número de muestras de entrenamiento, desde 1 hasta 10k.</li>
<li><strong>Pruning sin reentrenamiento</strong>: Evaluación de robustez al eliminar un porcentaje creciente de neuronas ocultas sin volver a entrenar.</li>
<li><strong>Especialización funcional</strong>: Análisis de la proporción de KCs especialistas y generalistas a través de métricas basadas en la sensibilidad por clase.</li>
<li><strong>Multimodalidad de activaciones</strong>: Se estudia la distribución del número efectivo de clases que activan cada KC, buscando indicios de subpoblaciones funcionales diferenciadas.</li>
</ul>
<h2 id="5-entradas-y-salidas">5. Entradas y Salidas</h2>
<ul>
<li><strong>Datos</strong>: MNIST (grises, 28×28 píxeles, 10 clases).</li>
<li><strong>Preprocesamiento</strong>: Flatten + normalización a [0, 1].</li>
<li><strong>Entrada del modelo</strong>: vectores de 784 dimensiones.</li>
<li><strong>Salida del modelo</strong>: logits (10 dimensiones), convertidos a probabilidades vía softmax.</li>
<li><strong>Métricas</strong>: accuracy, sparsity media, especialización funcional, robustez al pruning.</li>
</ul>
<h2 id="6-implementacion-tecnica">6. Implementación técnica</h2>
<table>
<thead>
<tr>
<th>Componente</th>
<th>Librería</th>
<th>Detalles técnicos</th>
</tr>
</thead>
<tbody>
<tr>
<td>BONN</td>
<td>CuPy</td>
<td>Máscaras binarias, operaciones vectorizadas en GPU</td>
</tr>
<tr>
<td>GateBONN</td>
<td>PyTorch</td>
<td>Uso de <code>torch.distributions.Beta</code>, <code>RelaxedBernoulli</code>, <code>nn.Module</code></td>
</tr>
<tr>
<td>Pruning</td>
<td>NumPy / CuPy</td>
<td>Eliminación de neuronas según índice</td>
</tr>
<tr>
<td>Visualización</td>
<td>Matplotlib</td>
<td>Histogramas de especialización, evolución de precisión</td>
</tr>
</tbody>
</table>
<h3 id="ficheros-clave">Ficheros clave</h3>
<ul>
<li><code>bonn.py</code>: clase BONN (CuPy)</li>
<li><code>gatebonn.py</code>: clase GateBONN (PyTorch)</li>
<li><code>ensemble.py</code>: funciones para crear y evaluar ensambles</li>
<li><code>experiments/</code>: scripts de evaluación rápida, pruning y análisis interno</li>
<li><code>utils/</code>: funciones de activación, inicialización y análisis de activaciones</li>
</ul>
<h2 id="7-requisitos">7. Requisitos</h2>
<pre><code class="language-bash">cupy&gt;=11.0.0
torch&gt;=2.0.0
matplotlib
scikit-learn
scipy
</code></pre>
<hr />
<p>Para un análisis más detallado del marco conceptual, referirse al Capítulo de Desarrollo del TFM. Allí se explican las motivaciones biológicas, las propiedades funcionales y los resultados experimentales con referencias cruzadas entre secciones.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
